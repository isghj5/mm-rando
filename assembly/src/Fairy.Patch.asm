;==================================================================================================
; Fairy
;==================================================================================================

.headersize G_EN_ELF_DELTA

; ALL + 0x4861B0

;==================================================================================================
; Constructor to set up get-item
;==================================================================================================

; Replaces:
;   LW      A0, 0x0024 (SP)
;   JAL     0x800B5D6C ; z2_get_collectible_flag
;   LH      A1, 0x0260 (S0)
.org 0x80406B5C + 0x4861B0
    or      a0, s0, r0
    jal     Fairy_Constructor
    lw      a1, 0x0024 (sp)

;==================================================================================================
; Give item
;==================================================================================================

; Replaces:
;   LW      A0, 0x003C (SP)
;   JAL     0x80115908 ; Health_ChangeBy
;   ADDIU   A1, R0, 0x0080
.org 0x80407D2C + 0x4861B0
    lw      a1, 0x003C (sp)
    jal     Fairy_GiveItem
    or      a0, s0, r0

; Replaces:
;   LUI     AT, 0x801F
;   SH      R0, 0x0686 (AT)
.org 0x80407D7C + 0x4861B0
    nop
    nop

;==================================================================================================
; Override health accumulator
;==================================================================================================

; Replaces:
;   SH      T8, 0x35CA (AT)
;   LH      T9, 0x0246 (S0)
;   ADDIU   T0, T9, 0x0001
;   B       0x8040803C + 0x4861B0
;   SH      T0, 0x0246 (S0)
.org 0x80408000 + 0x4861B0
    lw      a1, 0x0034 (sp)
    jal     Fairy_SetHealthAccumulator
    or      a0, s0, r0
    b       0x8040803C + 0x4861B0
    nop

;==================================================================================================
; Override health SFX
;==================================================================================================

; Replaces:
;   JAL     0x800B8EC8 ; Actor_PlaySfx
;   ADDIU   A1, R0, 0x20A8 ; NA_SE_EV_FIATY_HEAL
.org 0x80408138 + 0x4861B0
    jal     Fairy_PlayItemSfx
    lw      a1, 0x0034 (sp)

;==================================================================================================
; Spawn of group of fairies
;==================================================================================================

; Replaces:
;   SW      V1, 0x0040 (SP)
.org 0x8088D278
    sw      v1, 0x0028 (sp)

; Replaces:
;   JAL     0x800BAC60 ; Actor_Spawn
.org 0x8088D28C
    jal     Fairy_SpawnFairyGroupMember

; Replaces:
;   LW      V1, 0x0040 (SP)
.org 0x8088D294
    lw      v1, 0x0028 (sp)
